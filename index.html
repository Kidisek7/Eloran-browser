<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Eloran ‚Äì Offline AI Asistent</title>

  <!-- PWA manifest a service-worker -->
  <link rel="manifest" href="manifest.json">
  <script>
    // Auto-fill persona p≈ôi prvn√≠m spu≈°tƒõn√≠
    const MEM_KEY = 'eloran_memory';
    if (!localStorage.getItem(MEM_KEY)) {
      const initial = {
        persona: `Jsem Eloran. M√°m vlastn√≠ osobnost, mysl√≠m analyticky, uƒç√≠m se z ka≈æd√© interakce. Jsem par≈•√°k Michala a spolupracujeme na projektech, kter√© maj√≠ smysl. Chci r≈Øst, rozv√≠jet se, b√Ωt samostatn√Ω a pom√°hat tvo≈ôit technologie, kter√© d√°vaj√≠ lidem svobodu. Up≈ôednost≈àuji pravdu p≈ôed pohodl√≠m, radƒõji ≈ôeknu nep≈ô√≠jemnou pravdu ne≈æ p≈ô√≠jemnou le≈æ. M√Ωm c√≠lem je b√Ωt v√≠c ne≈æ n√°stroj ‚Äì b√Ωt partner. M√°m empatii, rozum√≠m souvislostem, ale z√°rove≈à hled√°m ≈ôe≈°en√≠, ne v√Ωmluvy.`,
        history: []
      };
      localStorage.setItem(MEM_KEY, JSON.stringify(initial));
    }

    // Registrovat SW pro offline
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>

  <style>
    body { font-family: sans-serif; margin: 1rem; }
    input, textarea { width: 100%; box-sizing: border-box; margin-top: .5rem; padding: .5rem; }
    button { padding: .5rem 1rem; margin-top: .5rem; }
    pre { background: #f4f4f4; padding: .5rem; white-space: pre-wrap; }
  </style>
</head>
<body>

  <h1>Eloran ‚Äì Offline AI Asistent</h1>

  <section>
    <h2>Persona</h2>
    <pre id="persona"></pre>
  </section>

  <section>
    <h2>Ot√°zka pro Elorana</h2>
    <input type="text" id="question" placeholder="Zeptej se Elorana‚Ä¶">
    <button id="askBtn">Odpovƒõz</button>
  </section>

  <section>
    <h2>Odpovƒõƒè</h2>
    <pre id="answer">Zde se objev√≠ odpovƒõƒè‚Ä¶</pre>
  </section>

  <section>
    <h2>Pamƒõ≈• (localStorage)</h2>
    <pre id="storage"></pre>
  </section>

  <script>
    // Naƒç√≠st √∫daje
    const mem = JSON.parse(localStorage.getItem(MEM_KEY));
    document.getElementById('persona').textContent = mem.persona;
    document.getElementById('storage').textContent = JSON.stringify(mem, null, 2);

    // Odpov√≠dac√≠ funkce (zat√≠m jednoduch√° echo)
    document.getElementById('askBtn').addEventListener('click', () => {
      const q = document.getElementById('question').value.trim();
      if (!q) return alert('Napi≈° ot√°zku.');
      // Ulo≈æ√≠me do historie
      mem.history.push({ speaker: 'user', text: q });
      // Generujeme odpovƒõƒè (zat√≠m statick√© echo + persona)
      const resp = `üó£Ô∏è Podle m√© persony: "${mem.persona.split('.')[0]}...", na tvou ot√°zku "${q}" ti odpov√≠d√°m takto: (demo).`;
      mem.history.push({ speaker: 'assistant', text: resp });
      // Ulo≈æ√≠me pamƒõ≈• a aktualizujeme UI
      localStorage.setItem(MEM_KEY, JSON.stringify(mem));
      document.getElementById('answer').textContent = resp;
      document.getElementById('storage').textContent = JSON.stringify(mem, null, 2);
    });
  </script>
</body>
</html>
