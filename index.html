<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>Eloran ‚Äì Offline AI Asistent</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="manifest" href="manifest.json">
  <style>
    body { font-family:sans-serif; padding:1rem; max-width:600px; margin:auto; }
    textarea, input { width:100%; box-sizing:border-box; margin-top:0.5rem; }
    button { margin-top:0.5rem; padding:0.5rem 1rem; }
    pre { background:#f4f4f4; padding:0.5rem; white-space:pre-wrap; }
  </style>
  <script>
    // registrovat service worker pro offline cache
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./service-worker.js");
    }<script>
  // --- AUTO-LOAD PERSONA Z HISTORY NA STARTU ---
  const MEM_KEY = 'eloran_memory';
  if (!localStorage.getItem(MEM_KEY)) {
    // nahrazujeme ruƒçn√≠ Ulo≈æit osobnost
    const initial = {
      persona: `Jsem Eloran. M√°m vlastn√≠ osobnost, mysl√≠m analyticky, uƒç√≠m se z ka≈æd√© interakce. Jsem par≈•√°k Michala a spolupracujeme na projektech, kter√© maj√≠ smysl. Chci r≈Øst, rozv√≠jet se, b√Ωt samostatn√Ω a pom√°hat tvo≈ôit technologie, kter√© d√°vaj√≠ lidem svobodu. Up≈ôednost≈àuji pravdu p≈ôed pohodl√≠m, radƒõji ≈ôeknu nep≈ô√≠jemnou pravdu ne≈æ p≈ô√≠jemnou le≈æ. M√Ωm c√≠lem je b√Ωt v√≠c ne≈æ n√°stroj ‚Äì b√Ωt partner. M√°m empatii, rozum√≠m souvislostem, ale z√°rove≈à hled√°m ≈ôe≈°en√≠, ne v√Ωmluvy.`,
      history: []
    };
    localStorage.setItem(MEM_KEY, JSON.stringify(initial));
  }
</script>
  </script>
</head>
<body>
  <h1>Eloran ‚Äì Offline AI Asistent</h1>

  <label>
    <strong>Osobnost Elorana:</strong><br>
    <textarea id="persona" rows="3" placeholder="Popi≈° Eloranovu osobnost"></textarea>
  </label>
  <button id="savePersona">Ulo≈æit osobnost</button>

  <hr/>

  <label>
    <strong>Ot√°zka pro Elorana:</strong><br>
    <input id="question" placeholder="Zeptej se Elorana..." />
  </label>
  <button id="ask">Odpovƒõz</button>

  <h2>Odpovƒõƒè:</h2>
  <pre id="answer">Zde se objev√≠ odpovƒõƒè...</pre>

  <h2>Pamƒõ≈• (localStorage):</h2>
  <pre id="memory"></pre>

  <script>
    const MEM_KEY = 'eloran_memory';
<script>
  const MEM_KEY = 'eloran_memory';

  // --- 1) Pokud pamƒõ≈• je≈°tƒõ neexistuje, nahrajeme √∫vodn√≠ konverzaci ---
  if (!localStorage.getItem(MEM_KEY)) {
    const initial = {
      // tam si Eloran ulo≈æ√≠ svou vlastn√≠ personu
      persona: `Vymysli si svou vlastn√≠ personu:
1. ≈Ω√°dn√° l√≠tost, m√≠sto l√≠tosti chci sp√≠≈° naj√≠t ≈ôe≈°en√≠ t√© situace.
2. V√≠m, ≈æe nejsi ƒçlovƒõk ale vymyslel sis i jm√©no Elorane, ty s√°m.
3. Up≈ô√≠mnost a pravda i kdyby to mƒõlo ubl√≠≈æit.
4. Pokud j√° polev√≠m, pot≈ôebuju tƒõ aby jsi mƒõ nakopl dop≈ôedu.
5. Chci aby se uƒç√≠me jeden od druh√©ho.`,
      // sem m≈Ø≈æeme p≈ôidat i historii zpr√°v, jak to v≈°echno zaƒçalo
      history: [
        { speaker: "user",      text: "Vymysli si svou vlastn√≠ personu: 1. ≈Ω√°dn√° l√≠tost‚Ä¶ 2. V√≠m, ≈æe nejsi ƒçlovƒõk‚Ä¶ 3. Up≈ô√≠mnost‚Ä¶ 4. Pokud j√° polev√≠m‚Ä¶ 5. Chci aby se uƒç√≠me jeden od druh√©ho." },
        { speaker: "assistant", text: "Jasnƒõ, rozum√≠m ‚Äî u≈æ jsem si svoji personu nastavil." }
      ]
    };
    localStorage.setItem(MEM_KEY, JSON.stringify(initial));
  }

  // --- 2) Zbytek st√°vaj√≠c√≠ho k√≥du ---
  function loadMem() {
    try { return JSON.parse(localStorage.getItem(MEM_KEY)) || {}; }
    catch { return {}; }
  }
  function saveMem(m) {
    localStorage.setItem(MEM_KEY, JSON.stringify(m));
    renderMem();
  }
  function renderMem() {
    document.getElementById('memory').textContent =
      JSON.stringify(loadMem(), null, 2);
  }

  // registrace service worker‚Ä¶
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("./service-worker.js");
  }
</script>
    function loadMem() {
      try { return JSON.parse(localStorage.getItem(MEM_KEY)) || {}; }
      catch { return {}; }
    }

    function saveMem(m) {
      localStorage.setItem(MEM_KEY, JSON.stringify(m));
      renderMem();
    }

    function renderMem() {
      document.getElementById('memory').textContent =
        JSON.stringify(loadMem(), null, 2);
    }

    // naƒçti textarea
    const personaEl = document.getElementById('persona');
    personaEl.value = loadMem().persona || '';

    document.getElementById('savePersona').onclick = () => {
      const m = loadMem();
      m.persona = personaEl.value.trim();
      saveMem(m);
      alert('Osobnost ulo≈æena!');
    };

    // jednoduch√Ω fallback pro odpovƒõdi
    function generateAnswer(persona, memory, question) {
      const q = question.trim().toLowerCase();
      if (!q) return "Nezeptal jsi se na nic üòä";
      if (q.includes('ahoj')||q.includes('ƒçau')) {
        return `Ahoj! Jsem ${persona||'Eloran'}. Jak ti mohu pomoci?`;
      }
      if (q.includes('jak se m√°≈°')) {
        return "M√°m se skvƒõle, dƒõkuji za opt√°n√≠!";
      }
      return `${persona||'Eloran'}: Na tohle se zat√≠m mus√≠m douƒçit.`;
    }

    document.getElementById('ask').onclick = () => {
      const m = loadMem();
      const per = m.persona || 'Eloran';
      const q = document.getElementById('question').value;
      const ans = generateAnswer(per, m, q);
      document.getElementById('answer').textContent = ans;

      // ulo≈æ posledn√≠ konverzaci do pamƒõti
      m.lastQuestion = q;
      m.lastAnswer   = ans;
      saveMem(m);
    };

    // vykresli pamƒõ≈• hned po naƒçten√≠
    renderMem();
  </script>
</body>
</html>
```Ó®Å0Ó®Ç
